{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '50347591-5bd4b47a011c37c1e11104459';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport async function getImagesByQuery(query, page) {\n    if (!query) {\n        console.error('Query is undefined or empty in getImagesByQuery.');\n        throw new Error('Search query is required.');\n    }\n    if (typeof page !== 'number' || page < 1) {\n        console.error(`Invalid page parameter: ${page}. Defaulting to page 1.`);\n        page = 1;\n    }\n\n\n    try {\n        const response = await axios.get(BASE_URL, {\n            params: {\n                key: API_KEY,\n                q: query,\n                image_type: 'photo',\n                orientation: 'horizontal',\n                safesearch: true,\n                page: page,\n                per_page: 15,\n            },\n        });\n\n        return response.data;\n    } catch (error) {\n        console.error('Error fetching images from Pixabay:', {\n            message: error.message,\n            status: error.response?.status,\n            data: error.response?.data,\n        });\n        throw new Error('Failed to fetch images from Pixabay API');\n    }\n}","import SimpleLightbox from \"simplelightbox\";\n\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst galleryContainer = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\n// const loadMoreBtn = document.querySelector('.load-more');\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n});\n\nexport function createGallery(images) {\n    const markup = images\n        .map(\n            ({\n                webformatURL,\n                largeImageURL,\n                tags,\n                likes,\n                views,\n                comments,\n                downloads,\n            }) => `\n      <li class=\"gallery-item\">\n        <a href=\"${largeImageURL}\">\n          <img src=\"${webformatURL}\" alt=\"${tags}\" />\n          <div class=\"info\">\n            <p><b>Likes</b> ${likes}</p>\n            <p><b>Views</b> ${views}</p>\n            <p><b>Comments</b> ${comments}</p>\n            <p><b>Downloads</b> ${downloads}</p>\n          </div>\n        </a>\n      </li>\n    `\n        )\n        .join('');\n\n    galleryContainer.insertAdjacentHTML('beforeend', markup);\n    lightbox.refresh();\n};\n\nexport function clearGallery() {\n    galleryContainer.innerHTML = '';\n};\n\nexport function showLoader() {\n    const loader = document.querySelector('.loader');\n    if (loader) {\n        loader.classList.add('visible');\n    } else {\n        console.error('Loader element not found.');\n    }\n}\n\nexport function hideLoader() {\n    const loader = document.querySelector('.loader');\n    if (loader) {\n        loader.classList.remove('visible');\n    } else {\n        console.error('Loader element not found.');\n    }\n}\n\nexport function showLoadMoreButton() {\n    const loadMoreBtn = document.querySelector('.load-more');\n    if (loadMoreBtn) {\n        loadMoreBtn.classList.add('visible');\n    } else {\n        console.error('Load More button not found.');\n    }\n}\n\nexport function hideLoadMoreButton() {\n    const loadMoreBtn = document.querySelector('.load-more');\n    if (loadMoreBtn) {\n        loadMoreBtn.classList.remove('visible');\n    }\n}","import { getImagesByQuery } from './js/pixabay-api.js';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport {\n    createGallery,\n    clearGallery,\n    showLoader,\n    hideLoader,\n    showLoadMoreButton,\n    hideLoadMoreButton,\n} from './js/render-functions.js';\n\nconst form = document.querySelector('.form');\nconst galleryContainer = document.querySelector('.gallery');\n\nlet currentQuery = '';\nlet currentPage = 1;\nlet totalHits = 0;\nlet loadMoreBtn = null;\nlet loader = null;\n\nfunction initializeLoader() {\n    loader = document.querySelector('.loader');\n    if (!loader) {\n        loader = document.createElement('span');\n        loader.classList.add('loader');\n        if (galleryContainer) {\n            galleryContainer.insertAdjacentElement('afterend', loader);\n        } else {\n        }\n    }\n}\n\nif (!form) {\n    iziToast.error({\n        title: 'Error',\n        message: 'Search form not found. Please check your HTML.',\n    });\n}\n\nif (!galleryContainer) {\n    iziToast.error({\n        title: 'Error',\n        message: 'Gallery container not found. Please check your HTML.',\n    });\n} else {\n    initializeLoader();\n}\n\nfunction createLoadMoreButton() {\n    if (!galleryContainer) {\n        iziToast.error({\n            title: 'Error',\n            message: 'Cannot create Load More button due to missing gallery container.',\n        });\n        return;\n    }\n\n    loadMoreBtn = document.createElement('button');\n    if (!loadMoreBtn) {\n        return;\n    }\n    loadMoreBtn.classList.add('load-more');\n    loadMoreBtn.textContent = 'Load more';\n\n    try {\n        galleryContainer.insertAdjacentElement('afterend', loadMoreBtn);\n\n        if (loader) {\n            loadMoreBtn.insertAdjacentElement('afterend', loader);\n        } else {\n            console.error('Loader is null during Load More button creation.');\n        }\n    } catch (error) {\n        console.error('Error inserting Load More button or loader:', error);\n        iziToast.error({\n            title: 'Error',\n            message: 'Failed to insert Load More button or loader into DOM.',\n        });\n        return;\n    }\n\n    if (loadMoreBtn) {\n        loadMoreBtn.addEventListener('click', handleLoadMore);\n    } else {\n    }\n}\n\nasync function handleLoadMore() {\n    currentPage += 1;\n    showLoader();\n    hideLoadMoreButton();\n\n    try {\n        if (typeof currentPage !== 'number' || currentPage < 1) {\n            currentPage = 1;\n        }\n        const data = await getImagesByQuery(currentQuery, currentPage);\n        createGallery(data.hits);\n\n        const galleryItem = document.querySelector('.gallery-item');\n        if (galleryItem) {\n            const { height: cardHeight } = galleryItem.getBoundingClientRect();\n            window.scrollBy({\n                top: cardHeight * 2,\n                behavior: 'smooth',\n            });\n        } else {\n            console.warn('No gallery items found for smooth scrolling.');\n        }\n\n        if (currentPage * 15 >= totalHits) {\n            hideLoadMoreButton();\n            iziToast.info({\n                title: 'Info',\n                message: \"We're sorry, but you've reached the end of search results.\",\n            });\n        } else {\n            showLoadMoreButton();\n        }\n    } catch (error) {\n        console.error('Error fetching more images:', error);\n        iziToast.error({\n            title: 'Error',\n            message: error.message.includes('401')\n                ? 'Invalid API key. Please check your Pixabay API key.'\n                : error.message.includes('429')\n                    ? 'Too many requests. Please wait and try again later.'\n                    : 'Failed to fetch images. Please try again later.',\n        });\n    } finally {\n        hideLoader();\n    }\n}\n\nif (form) {\n    form.addEventListener('submit', async (e) => {\n        e.preventDefault();\n\n        const searchInput = e.target.elements.searchQuery;\n        if (!searchInput) {\n            console.error('Input with name=\"searchQuery\" not found in form. Please check your HTML.');\n            iziToast.error({\n                title: 'Error',\n                message: 'Search input not found. Please ensure <input name=\"searchQuery\"> exists in the form.',\n            });\n            return;\n        }\n\n        const query = searchInput.value.trim();\n\n        if (!query) {\n            iziToast.error({\n                title: 'Error',\n                message: 'Please enter a search query',\n            });\n            return;\n        }\n\n        if (!galleryContainer) {\n            iziToast.error({\n                title: 'Error',\n                message: 'Gallery container not found. Please check your HTML.',\n            });\n            return;\n        }\n\n        currentQuery = query;\n        currentPage = 1;\n        clearGallery();\n        if (loadMoreBtn) {\n            loadMoreBtn.remove();\n            loadMoreBtn = null;\n            console.log('Previous Load More button removed.');\n        }\n        if (loader && galleryContainer) {\n            galleryContainer.insertAdjacentElement('afterend', loader);\n        }\n        hideLoadMoreButton();\n        showLoader();\n\n        try {\n            if (typeof currentPage !== 'number' || currentPage < 1) {\n                console.error(`Invalid currentPage: ${currentPage}. Resetting to 1.`);\n                currentPage = 1;\n            }\n            const data = await getImagesByQuery(currentQuery, currentPage);\n            totalHits = data.totalHits;\n\n            if (data.hits.length > 15) {\n                console.warn(`Expected 15 images, but received ${data.hits.length}. Check API parameters.`);\n            }\n\n            if (data.hits.length === 0) {\n                iziToast.error({\n                    title: 'Error',\n                    message: 'Sorry, there are no images matching your search query. Please try again!',\n                });\n                hideLoader();\n                return;\n            }\n\n            createGallery(data.hits);\n\n            if (!loadMoreBtn) {\n                createLoadMoreButton();\n            }\n\n            if (data.hits.length < 15 || currentPage * 15 >= totalHits) {\n                console.log('Hiding Load More button due to insufficient images or end of results.');\n                hideLoadMoreButton();\n                iziToast.info({\n                    title: 'Info',\n                    message: \"We're sorry, but you've reached the end of search results.\",\n                });\n            } else {\n                showLoadMoreButton();\n            }\n        } catch (error) {\n            console.error('Error fetching images:', error);\n            iziToast.error({\n                title: 'Error',\n                message: error.message.includes('401')\n                    ? 'Invalid API key. Please check your Pixabay API key.'\n                    : error.message.includes('429')\n                        ? 'Too many requests. Please wait and try again later.'\n                        : error.message.includes('page is not defined')\n                            ? 'Invalid page parameter. Please try again.'\n                            : 'Failed to fetch images. Please try again later.',\n            });\n        } finally {\n            hideLoader();\n            form.reset();\n        }\n    });\n} else {\n}"],"names":["API_KEY","BASE_URL","getImagesByQuery","query","page","axios","error","_a","_b","galleryContainer","lightbox","SimpleLightbox","createGallery","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","showLoader","loader","hideLoader","showLoadMoreButton","loadMoreBtn","hideLoadMoreButton","form","currentQuery","currentPage","totalHits","initializeLoader","iziToast","createLoadMoreButton","handleLoadMore","data","galleryItem","cardHeight","searchInput"],"mappings":"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"}